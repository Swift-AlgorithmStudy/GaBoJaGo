# Chap19. Depth-First Search

μ΄μ „ μ¥μ—μ„λ” λ‹¤μ λ‹¨κ³„λ΅ κ°€κΈ° μ „μ— μ •μ μ λ¨λ“  μ΄μ›ƒμ„ νƒν—ν•΄μ•Ό ν•λ” ν­ μ°μ„  κ²€μƒ‰(BFS)μ„ μ‚΄ν΄λ³΄μ•μµλ‹λ‹¤. μ΄ μ¥μ—μ„λ” κ·Έλν”„λ¥Ό κ°€λ΅μ§€λ¥΄κ±°λ‚ κ²€μƒ‰ν•λ” λ λ‹¤λ¥Έ μ•κ³ λ¦¬μ¦μΈ κΉμ΄ μ°μ„  κ²€μƒ‰(DFS)μ„ μ‚΄ν΄λ³Ό κ²ƒμ…λ‹λ‹¤.

DFSλ¥Ό μν–‰ν•λ ¤λ©΄, μ£Όμ–΄μ§„ μ†μ¤ μ •μ μΌλ΅ μ‹μ‘ν•μ—¬ λμ— λ„λ‹¬ν•  λ•κΉμ§€ κ°€λ¥ν• ν• μ§€μ μ„ νƒμƒ‰ν•λ ¤κ³  μ‹λ„ν•©λ‹λ‹¤. μ΄ μ‹μ μ—μ„, λ‹Ήμ‹ μ€ λ’¤λ΅ λ¬Όλ¬μ„μ„ λ‹Ήμ‹ μ΄ μ°Ύκ³  μλ” κ²ƒμ„ μ°Ύκ±°λ‚ λ¨λ“  μ •μ μ„ λ°©λ¬Έν•  λ•κΉμ§€ λ‹¤μ μ‚¬μ© κ°€λ¥ν• μ§€μ μ„ νƒν—ν•  κ²ƒμ…λ‹λ‹¤.

DFSμ—λ” λ§μ€ μ‘μ© ν”„λ΅κ·Έλ¨μ΄ μμµλ‹λ‹¤:

- **μ„μƒ μ •λ ¬(Topological sorting)**: 
κ·Έλν”„μ λ…Έλ“λ¥Ό μΌλ ¨μ μμ„λ΅ λ‚μ—΄ν•λ” μ‘μ—…μ…λ‹λ‹¤.
- **μ‚¬μ΄ν΄ κ°μ§€(Detecting a cycle)**: 
κ·Έλν”„μ—μ„ μ‚¬μ΄ν΄μ„ κ°μ§€ν•λ” μ‘μ—…μ…λ‹λ‹¤.
- **κ²½λ΅ μ°ΎκΈ°(Pathfinding)**: 
λ―Έλ΅ νΌμ¦κ³Ό κ°™μ€ λ¬Έμ μ—μ„ κ²½λ΅λ¥Ό μ°Ύλ” μ‘μ—…μ…λ‹λ‹¤.
- **ν¬μ† κ·Έλν”„μ—μ„ μ—°κ²° μ”μ† μ°ΎκΈ°(Finding connected components in a sparse graph)**: 
ν¬μ† κ·Έλν”„μ—μ„ μ—°κ²°λ κµ¬μ„± μ”μ†λ¥Ό μ°Ύλ” μ‘μ—…μ…λ‹λ‹¤.

## μμ‹

DFS μμ‹λ¥Ό μ‚΄ν΄λ΄…μ‹λ‹¤. μ•„λμ μμ‹ κ·Έλν”„λ” μ΄μ „ μ¥κ³Ό λ™μΌν•©λ‹λ‹¤. 
μ΄κ²ƒμ€ λ‹Ήμ‹ μ΄ BFSμ™€ DFSμ μ°¨μ΄μ μ„ λ³Ό μ μλ„λ΅ ν•κΈ° μ„ν•¨μ…λ‹λ‹¤.

<img src="https://github.com/Swift-AlgorithmStudy/GaBoJaGo/assets/100195563/cd80e5c7-5a6d-4fc8-9c08-2c5ad284f23a" width="500">

ν†µκ³Όν•λ” λ λ²¨μ„ μ¶”μ ν•κΈ° μ„ν•΄ μ¤νƒμ„ μ‚¬μ©ν•  κ²ƒμ…λ‹λ‹¤. **μ¤νƒμ Lifo(Last In First Out)μ ‘κ·Ό λ°©μ‹μ€ μ—­μ¶”μ μ— λ„μ›€μ΄ λλ‹¤**. μ¤νƒμ λ¨λ“  ν‘Έμ‹λ” λ‹Ήμ‹ μ΄ ν• λ‹¨κ³„ λ” κΉκ² μ›€μ§μΈλ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤. λ§‰λ‹¤λ¥Έ κ³¨λ©μ— λ„λ‹¬ν•λ©΄ μ΄μ „ λ λ²¨λ΅ λμ•„κ° μ μμµλ‹λ‹¤.

<img src="https://github.com/Swift-AlgorithmStudy/GaBoJaGo/assets/100195563/b23e85fb-7f8a-4483-9b64-9ee940dcef23" width="500">

1. Aλ¥Ό μ‹μ‘ μ •μ μΌλ΅ μ„ νƒν•κ³  μ¤νƒμ— μ¶”κ°€ν•©λ‹λ‹¤.
2. μ¤νƒμ΄ λΉ„μ–΄ μμ§€ μ•μ„ λ™μ• μ¤νƒμ μƒλ‹¨ μ •μ μ„ λ°©λ¬Έν•κ³  μ•„μ§ λ°©λ¬Έν•μ§€ μ•μ€ μ²« λ²μ§Έ μ΄μ›ƒ μ •μ μ„ μ¶”κ°€ν•©λ‹λ‹¤. Aλ¥Ό λ°©λ¬Έν•κ³  Bλ¥Ό μ¶”κ°€ν•μ„Έμ”.

<aside>
π‘€ μ΄μ „ μ¥μ—μ„ κ°€μ¥μλ¦¬λ¥Ό μ¶”κ°€ν•λ” μμ„κ°€ κ²€μƒ‰ κ²°κ³Όμ— μν–¥μ„ λ―ΈμΉλ‹¤λ” κ²ƒμ„ κΈ°μ–µν•μ„Έμ”. 
μ΄ κ²½μ°, Aμ— μ¶”κ°€λ μ²« λ²μ§Έ κ°€μ¥μλ¦¬λ” Bμ κ°€μ¥μλ¦¬μ€κΈ° λ•λ¬Έμ—, Bκ°€ λ¨Όμ € μ¶”κ°€λ©λ‹λ‹¤.

</aside>
<br></br>

<img src="https://github.com/Swift-AlgorithmStudy/GaBoJaGo/assets/100195563/91b7949a-1f4a-4d5d-b256-a6af8c68f273" width="500">

3. Aκ°€ μ΄λ―Έ λ°©λ¬Έλμ—κΈ° λ•λ¬Έμ— Bλ¥Ό λ°©λ¬Έν•κ³  Eλ¥Ό μ¶”κ°€ν•μ„Έμ”.
4. Eλ¥Ό λ°©λ¬Έν•κ³  Fλ¥Ό μ¶”κ°€ν•μ„Έμ”.

μ¤νƒμ„ λ„λ¥Ό λ•λ§λ‹¤ λ‚λ­‡κ°€μ§€ μ•„λλ΅ λ” λ©€λ¦¬ λ‚μ•„κ°„λ‹¤λ” μ μ— μ μν•μ„Έμ”. 

μΈμ ‘ν• λ¨λ“  μ •μ μ„ λ°©λ¬Έν•λ” λ€μ‹ μ—, **λμ— λ„λ‹¬ν• λ‹¤μ λλμ•„κ° λ•κΉμ§€ κΈΈμ„ κ³„μ† λ”°λΌκ°€μ„Έμ”.**
<br></br>

<img src="https://github.com/Swift-AlgorithmStudy/GaBoJaGo/assets/100195563/bf637c7e-c921-4dbc-b959-97a531f1e79e" width="500">

5. Fλ¥Ό λ°©λ¬Έν•κ³  Gλ¥Ό μ¶”κ°€ν•μ„Έμ”.
6. Gλ¥Ό λ°©λ¬Έν•κ³  Cλ¥Ό μ¶”κ°€ν•μ„Έμ”.

<br></br>

<img src="https://github.com/Swift-AlgorithmStudy/GaBoJaGo/assets/100195563/44fdff37-a66a-401d-99a3-e02e28c46e24" width="500">

7. λ‹¤μμΌλ΅ λ°©λ¬Έν•  μ •μ μ€ Cμ΄λ‹¤. μ΄μ›ƒ [A, F, G]μ΄ μμ§€λ§, μ΄ λ¨λ“  κ²ƒμ΄ λ°©λ¬Έλμ—λ‹¤. **λ§‰λ‹¤λ¥Έ κ³¨λ©μ— λ„λ‹¬ν–μΌλ―€λ΅, μ¤νƒμ—μ„ Cλ¥Ό κΊΌλ‚΄μ„ λλμ•„**κ° λ•μ…λ‹λ‹¤. ν C
8. μ΄κ²ƒμ€ Gλ΅ λ‹¤μ‹ λ°λ ¤μµλ‹λ‹¤. μ΄μ›ƒ [F, C]μ΄ μμ§€λ§, μ΄ λ¨λ“  κ²ƒμ΄ λ°©λ¬Έλμ—μµλ‹λ‹¤. λ λ‹¤λ¥Έ λ§‰λ‹¤λ¥Έ κ³¨λ©μ΄λΌλ©΄, ν G

<br></br>

<img src="https://github.com/Swift-AlgorithmStudy/GaBoJaGo/assets/100195563/c90aa31e-67bb-4bca-b7fe-6b9d762d28e0" width="500">

9. Fλ” λν• λ°©λ¬Έν•μ§€ μ•μ€ μ΄μ›ƒμ΄ λ‚¨μ•„ μμ§€ μ•κΈ° λ•λ¬Έμ—, ν F
10. μ΄μ , λ„λ” Eλ΅ λμ•„μ™”μ–΄. μ΄μ›ƒ Hλ” μ•„μ§ λ°©λ¬Έν•μ§€ μ•μ•μΌλ―€λ΅, μ¤νƒμ— Hλ¥Ό μ¶”κ°€ν•μ„Έμ”.

<br></br>

<img src="https://github.com/Swift-AlgorithmStudy/GaBoJaGo/assets/100195563/5c4dc6d7-1887-4348-89fa-42db1534f3af" width="500">

11. Hλ¥Ό λ°©λ¬Έν•λ” κ²ƒμ€ λ λ‹¤λ¥Έ λ§‰λ‹¤λ¥Έ κ³¨λ©μ„ μ΄λν•λ―€λ΅, ν H
12. Eλ” λν• λ°©λ¬Έ κ°€λ¥ν• μ΄μ›ƒμ΄ μ—†μΌλ―€λ΅, ν E
   
<br></br>

<img src="https://github.com/Swift-AlgorithmStudy/GaBoJaGo/assets/100195563/88602a75-ab17-4d90-a858-7ccc9c03c650" width="500">

13. Bλ„ λ§μ°¬κ°€μ§€λ΅ λ°©λ¬Έ κ°€λ¥ν• μ΄μ›ƒμ΄ μ—†μΌλ―€λ΅, ν B
14. μ΄κ²ƒμ€ Aλ΅ λμ•„κ°€κ² ν•©λ‹λ‹¤. Aμ μ΄μ›ƒ Dλ” μ—¬μ „ν λ°©λ¬Έν•΄μ•Ό ν•©λ‹λ‹¤. κ·Έλμ„ Dλ¥Ό μ¤νƒμ— μ¶”κ°€ν•©λ‹λ‹¤.
   
<br></br>

<img src="https://github.com/Swift-AlgorithmStudy/GaBoJaGo/assets/100195563/6fe0b4b3-1e6a-43f6-ad4f-67078104826c" width="500">

15. Dλ¥Ό λ°©λ¬Έν•λ” κ²ƒμ€ λ λ‹¤λ¥Έ λ§‰λ‹¤λ¥Έ κ³¨λ©μ„ μ΄λν•λ―€λ΅, ν D
16. Aλ΅ λμ•„μ™”μ§€λ§, μ΄λ²μ—λ” ν‘Έμ‹ν•  μμλ” μ΄μ›ƒμ΄ μ—†κΈ° λ•λ¬Έμ— Aλ¥Ό νν•μ„Έμ”. 
μ¤νƒμ€ μ΄μ  λΉ„μ–΄ μκ³  DFSλ” μ™„λ£λμ—λ‹¤.

μ •μ μ„ νƒν—ν•  λ•, λ°©λ¬Έν• κ°€μ§€λ¥Ό λ³΄μ—¬μ£Όλ” λ‚λ¬΄μ™€ κ°™μ€ κµ¬μ΅°λ¥Ό λ§λ“¤ μ μμµλ‹λ‹¤. 
DFSκ°€ BFSμ— λΉ„ν•΄ μ–Όλ§λ‚ κΉμ€μ§€ μ• μ μμµλ‹λ‹¤.

<br></br>

<img src="https://github.com/Swift-AlgorithmStudy/GaBoJaGo/assets/100195563/5474f306-c0b7-4981-9edb-f67c35431525" width="500">


## κµ¬ν„

ν”λ μ΄κ·ΈλΌμ΄λ“μ—λ” κ·Έλν”„μ κµ¬ν„κ³Ό DFSλ¥Ό κµ¬ν„ν•λ” λ° μ‚¬μ©ν•  μ¤νƒμ΄ ν¬ν•¨λμ–΄ μμµλ‹λ‹¤.

```swift
extension Graph where Element: Hashable {
  func depthFirstSearch(from source: Vertex<Element>)
      -> [Vertex<Element>] {
    var stack: Stack<Vertex<Element>> = []
    var pushed: Set<Vertex<Element>> = []
    var visited: [Vertex<Element>] = []

    stack.push(source)
    pushed.insert(source)
    visited.append(source)

    // more to come ...

    return visited
  }
}
```

 μ‹μ‘ μ •μ μ„ μ·¨ν•κ³  λ°©λ¬Έν• μμ„λ€λ΅ μ •μ  λ©λ΅μ„ λ°ν™ν•λ” λ°©λ²• depthFirstSearch(from:)λ¥Ό μ •μν–μµλ‹λ‹¤. μ„Έ κ°€μ§€ λ°μ΄ν„° κµ¬μ΅°λ¥Ό μ‚¬μ©ν•λ‹¤:

1. `stack`μ€ κ·Έλν”„λ¥Ό ν†µν•΄ κ²½λ΅λ¥Ό μ €μ¥ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤.
2. `push`λ” μ΄μ „μ— μ–΄λ–¤ μ •μ μ΄ λ°€λ Έλ”μ§€ κΈ°μ–µν•λ―€λ΅ κ°™μ€ μ •μ μ„ λ‘ λ² λ°©λ¬Έν•μ§€ μ•μµλ‹λ‹¤. κ·Έκ²ƒμ€ λΉ λ¥Έ O(1) μ΅°νλ¥Ό λ³΄μ¥ν•κΈ° μ„ν• μ„ΈνΈμ΄λ‹¤.
3. `visited`μ€ μ •μ μ΄ λ°©λ¬Έν• μμ„λ¥Ό μ €μ¥ν•λ” λ°°μ—΄μ΄λ‹¤.

μ•κ³ λ¦¬μ¦μ„ μ‹μ‘ν•λ ¤λ©΄, **μ„Έ κ°€μ§€ λ¨λ‘μ— μ†μ¤ μ •μ μ„ μ¶”κ°€**ν•μ„Έμ”.

λ‹¤μμΌλ΅, μ£Όμ„μ„ λ‹¤μκ³Ό κ°™μ΄ λ€μ²΄ν•μ—¬ λ©”μ„λ“λ¥Ό μ™„λ£ν•μ„Έμ”:

```swift
extension Graph where Element: Hashable {
  func depthFirstSearch(from source: Vertex<Element>)
      -> [Vertex<Element>] {
    var stack: Stack<Vertex<Element>> = []
    var pushed: Set<Vertex<Element>> = []
    var visited: [Vertex<Element>] = []

    stack.push(source)
    pushed.insert(source)
    visited.append(source)

    outer: while let vertex = stack.peek() { // 1
		  let neighbors = edges(from: vertex) // 2
		  guard !neighbors.isEmpty else { // 3
		    stack.pop()
		    continue
		  }
		  for edge in neighbors { // 4
		    if !pushed.contains(edge.destination) {
		      stack.push(edge.destination)
		      pushed.insert(edge.destination)
		      visited.append(edge.destination)
		      continue outer // 5
		    }
		  }
		  stack.pop() // 6
		}

    return visited
  }
}
```

1. μ¤νƒμ΄ λΉ„μ–΄ μμ„ λ•κΉμ§€ μ¤νƒ μƒλ‹¨μ μ •μ μ„ κ³„μ† ν™•μΈν•©λ‹λ‹¤. μ¤‘μ²©λ λ£¨ν”„ λ‚΄μ—μ„λ„ λ‹¤μ μ •μ μΌλ΅ κ³„μ†ν•  μ μλ„λ΅ μ΄ λ£¨ν”„ μ™Έλ¶€μ— λ μ΄λΈ”μ„ μ§€μ •ν–μµλ‹λ‹¤.
2. ν„μ¬ μ •μ μ λ¨λ“  μ΄μ›ƒ κ°€μ¥μλ¦¬λ¥Ό μ°Ύμ„ μ μμµλ‹λ‹¤.
3. κ°€μ¥μλ¦¬κ°€ μ—†λ‹¤λ©΄, μ¤νƒμ—μ„ μ •μ μ„ ν„°λ¨λ¦¬κ³  λ‹¤μ λ‹¨κ³„λ΅ κ³„μ†ν•μ„Έμ”.
4. μ—¬κΈ°μ„, ν„μ¬ μ •μ μ— μ—°κ²°λ λ¨λ“  κ°€μ¥μλ¦¬λ¥Ό λ°λ³µν•κ³  μ΄μ›ƒ μ •μ μ΄ λ°©λ¬Έλμ—λ”μ§€ ν™•μΈν•©λ‹λ‹¤. λ°©λ¬Έν•μ§€ μ•μ•λ‹¤λ©΄, κ·Έκ²ƒμ„ μ¤νƒμ— ν‘Έμ‹ν•κ³  λ°©λ¬Έν• λ°°μ—΄μ— μ¶”κ°€ν•©λ‹λ‹¤. μ΄ μ •μ μ„ λ°©λ¬Έν• κ²ƒμΌλ΅ ν‘μ‹ν•λ” κ²ƒμ€ μ•„μ§ λ“¤μ—¬λ‹¤λ³΄μ§€ μ•μ•κΈ° λ•λ¬Έμ— μ΄λ¥Έ κ²ƒμ²λΌ λ³΄μΌ μ μμ§€λ§, μ •μ μ΄ μ¤νƒμ— μ¶”κ°€λλ” μμ„λ€λ΅ (μ–΄μ§ν”Ό !) λ°©λ¬ΈλκΈ° λ•λ¬Έμ— μ¬λ°”λ¥Έ μμ„λ΅ ν‘μ‹λ©λ‹λ‹¤.
5. μ΄μ  λ°©λ¬Έν•  μ΄μ›ƒμ„ μ°Ύμ•μΌλ‹, μ™Έλ¶€ λ£¨ν”„λ¥Ό κ³„μ†ν•κ³  μƒλ΅ ν‘Έμ‹λ μ΄μ›ƒμΌλ΅ μ΄λ™ν•©λ‹λ‹¤.
6. ν„μ¬ μ •μ μ— λ°©λ¬Έν•μ§€ μ•μ€ μ΄μ›ƒμ΄ μ—†λ‹¤λ©΄, λ§‰λ‹¤λ¥Έ κ³¨λ©μ— λ„λ‹¬ν–κ³  μ¤νƒμ—μ„ κΊΌλ‚Ό μ μλ‹¤λ” κ²ƒμ„ μ• μ μμµλ‹λ‹¤.

μ¤νƒμ΄ λΉ„μ–΄ μμΌλ©΄, DFS μ•κ³ λ¦¬μ¦μ΄ μ™„λ£λ©λ‹λ‹¤! λ‹Ήμ‹ μ΄ ν•΄μ•Ό ν•  μΌμ€ λ°©λ¬Έν• μ •μ μ„ λ°©λ¬Έν• μμ„λ€λ΅ λλλ¦¬λ” κ²ƒλΏμ…λ‹λ‹¤.

## μ„±λ¥ Performance

DFSλ” μ μ–΄λ„ ν• λ²μ€ λ¨λ“  μ •μ μ„ λ°©λ¬Έν•  κ²ƒμ΄λ‹¤. μ΄ κ³Όμ •μ€ O(V)μ μ‹κ°„ λ³µμ΅μ„±μ„ κ°€μ§€κ³  μλ‹¤.

DFSμ—μ„ κ·Έλν”„λ¥Ό ν΅λ‹¨ν•  λ•, λ°©λ¬Έν•  μ μλ” λ¨λ“  μΈμ ‘ μ •μ μ„ ν™•μΈν•΄μ•Ό ν•©λ‹λ‹¤. μ΄κ²ƒμ μ‹κ°„ λ³µμ΅μ„±μ€ O(E)μ…λ‹λ‹¤. μ™λƒν•λ©΄ μµμ•…μ κ²½μ° κ·Έλν”„μ λ¨λ“  κ°€μ¥μλ¦¬λ¥Ό λ°©λ¬Έν•΄μ•Ό ν•κΈ° λ•λ¬Έμ…λ‹λ‹¤.

μ „λ°μ μΌλ΅, κΉμ΄ μ°μ„  κ²€μƒ‰μ **μ‹κ°„ λ³µμ΅μ„±μ€ O(V + E)**μ΄λ‹¤.

μ„Έ κ°€μ§€ λ³„λ„μ λ°μ΄ν„° κµ¬μ΅°μ— μ •μ μ„ μ €μ¥ν•΄μ•Ό ν•κΈ° λ•λ¬Έμ— κΉμ΄ μ°μ„  κ²€μƒ‰μ **κ³µκ°„ λ³µμ΅μ„±μ€** **O(V)**μ…λ‹λ‹¤: stack, push, visited.

## π—οΈΒ Key points

- κΉμ΄ μ°μ„  κ²€μƒ‰(DFS)μ€ κ·Έλν”„λ¥Ό ν†µκ³Όν•κ±°λ‚ κ²€μƒ‰ν•λ” λ λ‹¤λ¥Έ μ•κ³ λ¦¬μ¦μ΄λ‹¤.
- DFSλ” λμ— λ„λ‹¬ν•  λ•κΉμ§€ κ°€λ¥ν• ν• μ§€μ μ„ νƒκµ¬ν•λ‹¤.
- μ¤νƒ λ°μ΄ν„° κµ¬μ΅°λ¥Ό ν™μ©ν•μ—¬ κ·Έλν”„μ—μ„ μ–Όλ§λ‚ κΉμ€μ§€ μ¶”μ ν•μ„Έμ”. λ§‰λ‹¤λ¥Έ κ³¨λ©μ— λ„λ‹¬ν–μ„ λ•λ§ μ¤νƒμ—μ„ popν•μ„Έμ”.
